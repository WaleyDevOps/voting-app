pipeline {
    
    tools {
        nodejs 'NodeJS 8.9.0'
    }

    agent any 
    stages {
        stage('Build') { 
            when {
                changeset '**/result/**'
            }
            steps {
                echo 'Compiling result app'
                dir('result'){
                sh 'npm install' 
                }
                
            }
        }
        stage('Test') { 
            when {
                changeset '**/result/**'
            }
            steps {
                echo 'Running unit Test on result app' 
                dir('result'){
                sh 'npm install'     
                sh 'npm test' 
                }
            }
        }
    //     stage('Package') { 
    //         when {
    //             branch 'main'
    //             changeset '**/result/**'
    //         }
    //         steps {
    //             echo 'Packaging worker app' 
    //             dir('worker'){
    //             sh 'mvn package -DskipTests' 
    //             archiveArtifacts artifacts: '**/target/*.jar', fingerprint: true
    //             }
    //         }
    //     }
    
    // }

    post {
        always {
            echo 'Build pipeline for result is completed'
        }
        // failure{
        //     slackSend (channel "my-slack-notified" message: "Build Failed: ${env.JOB_NAME} ${env.BUILD_NUMBER}")
        // }
        // success{
        //     slackSend (channel "my-slack-notified", message: "Build Succeeded: ${env.JOB_NAME} ${env.BUILD_NUMBER}")
        // }
    }

    
}